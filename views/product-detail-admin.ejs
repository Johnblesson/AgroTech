<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FarmLink SL â€“ Product Details</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Ionicons -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  <style>
    body {
      font-family: 'Nunito Sans', sans-serif;
      background-color: #f4f6f5;
      margin: 0;
      padding: 0;
    }

    .property-list {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      padding: 30px 15px;
    }

    .carousel {
      position: relative;
      width: 100%;
      max-width: 900px;
      height: 450px;
      overflow: hidden;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      margin-bottom: 20px;
    }

    .carousel-item {
      display: none;
      width: 100%;
      height: 100%;
    }

    .carousel-item.active {
      display: block;
    }

    .carousel-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .download-btn {
      position: absolute;
      bottom: 15px;
      right: 15px;
      background-color: #4CAF50;
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 5px;
      font-weight: 600;
    }

    .download-btn:hover {
      background-color: #45a049;
    }

    .thumbnail-container {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 10px 0 30px;
    }

    .thumbnail {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border 0.3s ease;
    }

    .thumbnail.active {
      border-color: #4CAF50;
    }

    .main-card {
      width: 100%;
      max-width: 900px;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      padding: 25px 30px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .main-card .card-title {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0;
      color: #2c974b;
    }

    .main-card .card-price {
      font-size: 1.4rem;
      font-weight: 700;
      color: #4CAF50;
    }

    .main-card .card-text {
      font-size: 1rem;
      line-height: 1.6;
      color: #444;
    }

    /* Product Details Card */
    .product-details-card {
      background: #f7f9f7;
      border-radius: 14px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    }

    .product-details-card h3 {
      font-size: 1.3rem;
      margin-bottom: 12px;
      color: #2c974b;
      font-weight: 600;
    }

    .product-details-card p {
      font-size: 1rem;
      margin: 6px 0;
      line-height: 1.5;
      color: #444;
    }

    .btn-buy {
      display: inline-block;
      padding: 12px 25px;
      background-color: #4CAF50;
      color: #fff;
      font-weight: 600;
      border-radius: 8px;
      text-decoration: none;
      text-align: center;
      margin-top: 20px;
      transition: background-color 0.3s ease;
    }

    .btn-buy:hover {
      background-color: #45a049;
    }

    .product-links {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .product-links a {
      color: #4CAF50;
      text-decoration: none;
    }

    .product-links a:hover {
      text-decoration: underline;
    }

    .card-footer {
      margin-top: 25px;
      font-size: 0.9rem;
      color: #555;
    }
  </style>
</head>

<body>
  <div class="property-list">

    <!-- Carousel -->
    <div class="carousel">
      <% if (product.photoUrls && product.photoUrls.length > 0) { %>
        <% product.photoUrls.forEach((photoUrl, index) => { %>
          <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
            <img src="<%= photoUrl %>" class="carousel-img" alt="Product Photo">
            <a href="<%= photoUrl %>" download class="download-btn">
              <ion-icon name="download-outline"></ion-icon>
              Download
            </a>
          </div>
        <% }) %>
      <% } else { %>
        <div class="carousel-item active">
          <p>No photo available</p>
        </div>
      <% } %>
    </div>

    <div class="thumbnail-container">
      <% if (product.photoUrls && product.photoUrls.length > 0) { %>
        <% product.photoUrls.forEach((photoUrl, index) => { %>
          <img src="<%= photoUrl %>" class="thumbnail <%= index === 0 ? 'active' : '' %>" data-index="<%= index %>" alt="Thumbnail">
        <% }) %>
      <% } %>
    </div>

    <!-- Main Card -->
    <div class="main-card">
      <h2 class="card-title"><%= product.title %></h2>
      <div class="card-price"><%= product.currency %> <%= product.price.toLocaleString() %> <span><%= product.duration %></span></div>
      <p class="card-text"><%= product.description %></p>

      <!-- Product Details Card -->
      <div class="product-details-card">
        <h3>Product Details</h3>
        <p><strong>Location:</strong> <%= product.location %></p>
        <p><strong>Region:</strong> <%= product.region %></p>
        <p><strong>Type:</strong> <%= product.typeOfProduct %></p>
        <p><strong>Availability:</strong> <%= product.availability %></p>
        <p><strong>Negotiation:</strong> <%= product.negotiation %></p>
      </div>

      <!-- <a href="/admin-application-form?pid=<%= product.pid %>&location=<%= product.location %>&title=<%= product.title %>&price=<%= product.price %>" class="btn-buy">APPLY/BUY NOW</a> -->
      <a href="/admin-application-form?pid=<%= product.pid %>&location=<%= product.location %>&title=<%= product.title %>&price=<%= product.price %>" class="btn-buy">
        <ion-icon name="cart-outline" style="vertical-align: middle; margin-right: 8px;"></ion-icon>
        APPLY/BUY NOW
      </a>

      <div class="product-links">
        <p>Before applying, please review:</p>
        <a href="/terms-and-conditions">Terms and Conditions</a>
        <a href="/services-fee-agreement">Service Fee Agreement</a>
        <a href="/privacy-policy">Privacy Policy</a>
      </div>

      <div class="card-footer">
        Created by: <%= product.createdBy %> | <%= product.formattedCreatedAt %> (<%= product.daysAgo %> days ago)
      </div>
    </div>

  </div>

  <!-- Scripts -->
  <script>
    let slideIndex = 0;
    const carouselItems = document.querySelectorAll('.carousel-item');
    const thumbnails = document.querySelectorAll('.thumbnail');

    function showSlides() {
      carouselItems.forEach(item => item.style.display = "none");
      thumbnails.forEach(item => item.classList.remove('active'));
      slideIndex++;
      if (slideIndex > carouselItems.length) slideIndex = 1;
      carouselItems[slideIndex - 1].style.display = "block";
      thumbnails[slideIndex - 1].classList.add('active');
      setTimeout(showSlides, 3000);
    }

    function showSlide(index) {
      carouselItems.forEach(item => item.style.display = "none");
      thumbnails.forEach(item => item.classList.remove('active'));
      carouselItems[index].style.display = "block";
      thumbnails[index].classList.add('active');
      slideIndex = index;
    }

    thumbnails.forEach((thumb, i) => thumb.addEventListener('click', () => showSlide(i)));
    showSlides();
  </script>
</body>
</html>
